# Runic Trade Alerts Specification

This document defines the data structure and logic for "Runic Trade Alerts," which are the visual representation of WizardWave signals in the Wizard Portal.

## Data Structure

Each alert object should contain the following fields:

| Field | Type | Description | Example |
| :--- | :--- | :--- | :--- |
| **Asset** | String | The trading pair or instrument name. | `BTC/USDT`, `^NDX` |
| **Type** | String | Direction of the trade with visual indicator. | `⬆️ LONG`, `⬇️ SHORT` |
| **Timeframe** | String | The candle timeframe of the signal. | `4 Hours`, `1 Day` |
| **Entry Time** | String | Timestamp of the signal generation (EST preferred). | `2024-12-14 14:30:00` |
| **Entry Price** | Float | The price at which the trade is entered (Close of signal candle). | `98500.00` |
| **Take Profit** | Float | Target price for profit taking. | `106380.00` |
| **Stop Loss** | Float | Price level to exit if trade goes wrong. | `93575.00` |
| **Confidence** | Percentage | ML Model's probability score for the trade success. | `85%` |
| **Action** | String | Recommendation based on confidence threshold (0.40). | `✅ TAKE`, `❌ SKIP` |
| **PnL (%)** | String | Current unrealized PnL if the trade is active. | `+1.25%` |

## Logic & Calculation

### 1. Signal Identification
Signals are generated by the `WizardWaveStrategy` class in `strategy.py`.
- **Long Signal:** `signal_type == 'LONG_TREND'` or `'LONG_BREAKOUT'` (Buying pressure > threshold).
- **Short Signal:** `signal_type == 'SHORT_TREND'` or `'SHORT_BREAKOUT'` (Selling pressure > threshold).

### 2. Take Profit (TP) & Stop Loss (SL) Calculation
TP and SL levels are calculated dynamically based on the asset class and entry price.

**Configuration:**
- **Crypto Assets:**
  - Take Profit: **8%** (`0.08`)
  - Stop Loss: **5%** (`0.05`)
- **TradFi Assets (Stocks/Forex/Futures):**
  - Take Profit: **3%** (`0.03`)
  - Stop Loss: **4%** (`0.04`)

**Formula:**
- **Long Trade:**
  - `TP = Entry_Price * (1 + TP_Pct)`
  - `SL = Entry_Price * (1 - SL_Pct)`
- **Short Trade:**
  - `TP = Entry_Price * (1 - TP_Pct)`
  - `SL = Entry_Price * (1 + SL_Pct)`

### 3. Confidence Scoring
Derived from the `RandomForestClassifier` model (`model.pkl`).
- **Feature Vector:** `[volatility, rsi, ma_dist, adx, mom]`
- **Probability:** `model.predict_proba(features)[1]` (Probability of Class 1 "Profitable")
- **Threshold:** `0.40`
  - If `Probability > 0.40` → `Action = ✅ TAKE`
  - If `Probability <= 0.40` → `Action = ❌ SKIP`

## Visual Style Guide (Wizard Portal)
- **Background:** Dark theme (matches Wizard Portal aesthetic).
- **Long Signals:** Green accents / Up arrows.
- **Short Signals:** Red accents / Down arrows.
- **Take Action:** Highlighted Green background (rgba(0, 255, 0, 0.2)).
- **Skip Action:** Dimmed or Red-tinted background (rgba(255, 0, 0, 0.1)).
